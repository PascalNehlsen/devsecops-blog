"use strict";(self.webpackChunkdso_dev_blog=self.webpackChunkdso_dev_blog||[]).push([[325],{6334:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});var s=t(4848),i=t(8453);const l={},d="PDF Download/ Scan Metadata Tool",r={id:"projects/python-tools/metascan/overview",title:"PDF Download/ Scan Metadata Tool",description:"This repository contains a Python tool that automates the process of downloading all PDF documents from a given webpage and extracting their metadata. The extracted metadata is then saved into a CSV file.",source:"@site/docs/projects/python-tools/metascan/00-overview.md",sourceDirName:"projects/python-tools/metascan",slug:"/projects/python-tools/metascan/overview",permalink:"/devsecops-blog/docs/projects/python-tools/metascan/overview",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:0,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"PDF Remove Metadata",permalink:"/devsecops-blog/docs/projects/python-tools/remove-metadata/overview"},next:{title:"PDF Metadata Scan",permalink:"/devsecops-blog/docs/projects/python-tools/metadata/overview"}},a={},o=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Features",id:"features",level:2},{value:"Getting Started",id:"getting-started",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Installation",id:"installation",level:3},{value:"Usage",id:"usage",level:2},{value:"Command-Line Options",id:"command-line-options",level:3},{value:"Examples",id:"examples",level:3},{value:"Output CSV",id:"output-csv",level:2},{value:"Example CSV Output",id:"example-csv-output",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Contact",id:"contact",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"pdf-download-scan-metadata-tool",children:"PDF Download/ Scan Metadata Tool"})}),"\n",(0,s.jsx)(n.p,{children:"This repository contains a Python tool that automates the process of downloading all PDF documents from a given webpage and extracting their metadata. The extracted metadata is then saved into a CSV file."}),"\n",(0,s.jsx)(n.admonition,{title:"Only for Testing Purposes",type:"danger",children:(0,s.jsx)(n.p,{children:"This tool is intended for educational and authorized penetration testing purposes only. Unauthorized use of this tool against systems that you do not have explicit permission to test is illegal and unethical."})}),"\n",(0,s.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#features",children:"Features"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#getting-started",children:"Getting Started"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#prerequisites",children:"Prerequisites"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#installation",children:"Installation"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#usage",children:"Usage"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#command-line-options",children:"Command-Line Options"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#examples",children:"Examples"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#output-csv",children:"Output CSV"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#error-handling",children:"Error Handling"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#contact",children:"Contact"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,s.jsx)(n.p,{children:"This tool offers the following features:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Download PDFs"}),": Automatically downloads all PDF files found on a given webpage."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Extract Metadata"}),": Extracts metadata from each PDF, including the following fields:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Title"}),"\n",(0,s.jsx)(n.li,{children:"Author"}),"\n",(0,s.jsx)(n.li,{children:"Creator"}),"\n",(0,s.jsx)(n.li,{children:"Created (Creation Date)"}),"\n",(0,s.jsx)(n.li,{children:"Modified (Modification Date)"}),"\n",(0,s.jsx)(n.li,{children:"Subject"}),"\n",(0,s.jsx)(n.li,{children:"Keywords"}),"\n",(0,s.jsx)(n.li,{children:"Description"}),"\n",(0,s.jsx)(n.li,{children:"Producer"}),"\n",(0,s.jsx)(n.li,{children:"PDF Version"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Save to CSV"}),": The extracted metadata is saved into a CSV file, where each row represents one PDF document."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,s.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(n.p,{children:"Before running the script, make sure you have the following installed:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Python 3.7 or higher"})}),"\n",(0,s.jsxs)(n.li,{children:["Python libraries:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"requests"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"beautifulsoup4"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"PyPDF2"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["You can install these dependencies using ",(0,s.jsx)(n.code,{children:"pip"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"pip install requests beautifulsoup4 PyPDF2\n"})}),"\n",(0,s.jsx)(n.h3,{id:"installation",children:"Installation"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Clone the Repository"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"git clone https://github.com/yourusername/metascan.git\r\ncd metascan\n"})}),"\n",(0,s.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(n.p,{children:"This tool is run via the command line and offers a few options for customizing the operation."}),"\n",(0,s.jsx)(n.h3,{id:"command-line-options",children:"Command-Line Options"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Option"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Required"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"-u"})}),(0,s.jsx)(n.td,{children:"The URL of the webpage to scan for PDF files"}),(0,s.jsx)(n.td,{children:"x"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"-n"})}),(0,s.jsx)(n.td,{children:"The name of the output CSV file"}),(0,s.jsx)(n.td,{children:"x"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Download PDFs and Extract Metadata from a Webpage"})}),"\n",(0,s.jsx)(n.p,{children:"To download all PDFs from a given webpage and extract their metadata:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"python metascan.py -u https://example.com -n output.csv\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["This command will scan ",(0,s.jsx)(n.code,{children:"https://example.com"})," for PDF files, download them, and save their metadata to a file called ",(0,s.jsx)(n.code,{children:"output.csv"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Specifying a Different Output File"})}),"\n",(0,s.jsx)(n.p,{children:"You can specify a different name for the output CSV file:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"python metascan.py -u https://example.com -n my_metadata.csv\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["This will save the metadata to ",(0,s.jsx)(n.code,{children:"my_metadata.csv"})," instead of the default ",(0,s.jsx)(n.code,{children:"output.csv"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"output-csv",children:"Output CSV"}),"\n",(0,s.jsx)(n.p,{children:"The output CSV file will contain metadata for each PDF file in a structured format. Each row corresponds to one PDF, and the following fields (columns) are included:"}),"\n",(0,s.jsx)(n.h2,{id:"example-csv-output",children:"Example CSV Output"}),"\n",(0,s.jsx)(n.p,{children:"The CSV file generated by the tool will look like the table below, with semicolons (;) separating the values:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Title"}),(0,s.jsx)(n.th,{children:"Author"}),(0,s.jsx)(n.th,{children:"Creator"}),(0,s.jsx)(n.th,{children:"Created"}),(0,s.jsx)(n.th,{children:"Modified"}),(0,s.jsx)(n.th,{children:"Subject"}),(0,s.jsx)(n.th,{children:"Keywords"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Producer"}),(0,s.jsx)(n.th,{children:"PDF Version"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Sample PDF"}),(0,s.jsx)(n.td,{children:"John Doe"}),(0,s.jsx)(n.td,{children:"PDF Tool"}),(0,s.jsx)(n.td,{children:"2022-01-01"}),(0,s.jsx)(n.td,{children:"2022-01-05"}),(0,s.jsx)(n.td,{children:"Report"}),(0,s.jsx)(n.td,{children:"Data"}),(0,s.jsx)(n.td,{children:"Sample file"}),(0,s.jsx)(n.td,{children:"Adobe"}),(0,s.jsx)(n.td,{children:"1.7"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Example Doc"}),(0,s.jsx)(n.td,{children:"Jane Roe"}),(0,s.jsx)(n.td,{children:"PDFGen"}),(0,s.jsx)(n.td,{children:"2023-05-03"}),(0,s.jsx)(n.td,{children:"2023-05-10"}),(0,s.jsx)(n.td,{children:"Invoice"}),(0,s.jsx)(n.td,{children:"Billing"}),(0,s.jsx)(n.td,{children:"Invoice file"}),(0,s.jsx)(n.td,{children:"LibreOffice"}),(0,s.jsx)(n.td,{children:"1.6"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Test PDF"}),(0,s.jsx)(n.td,{children:"None"}),(0,s.jsx)(n.td,{children:"None"}),(0,s.jsx)(n.td,{children:"2020-12-12"}),(0,s.jsx)(n.td,{children:"2020-12-13"}),(0,s.jsx)(n.td,{children:"Manual"}),(0,s.jsx)(n.td,{children:"None"}),(0,s.jsx)(n.td,{children:"User manual"}),(0,s.jsx)(n.td,{children:"Foxit"}),(0,s.jsx)(n.td,{children:"1.4"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Report 2022"}),(0,s.jsx)(n.td,{children:"Mark Smith"}),(0,s.jsx)(n.td,{children:"ReportGen"}),(0,s.jsx)(n.td,{children:"2022-02-15"}),(0,s.jsx)(n.td,{children:"2022-02-16"}),(0,s.jsx)(n.td,{children:"Annual"}),(0,s.jsx)(n.td,{children:"Report"}),(0,s.jsx)(n.td,{children:"Yearly Report"}),(0,s.jsx)(n.td,{children:"Adobe"}),(0,s.jsx)(n.td,{children:"1.7"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["The entries in the CSV file are separated by semicolons (",(0,s.jsx)(n.code,{children:";"}),")."]}),"\n",(0,s.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,s.jsx)(n.p,{children:"In cases where a PDF file cannot be read or if the metadata is incomplete, the tool will log the error and move on to the next file without stopping the entire process. It will also print a message in the terminal indicating which files had issues."}),"\n",(0,s.jsx)(n.p,{children:"Example error message:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"Error reading metadata from pdf_downloads/document.pdf: EOF marker not found\n"})}),"\n",(0,s.jsx)(n.h2,{id:"contact",children:"Contact"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Pascal Nehlsen - ",(0,s.jsx)(n.a,{href:"https://www.linkedin.com/in/pascal-nehlsen",children:"LinkedIn"})," - ",(0,s.jsx)(n.a,{href:"mailto:mail@pascal-nehlsen.de",children:"mail@pascal-nehlsen.de"})]}),"\n",(0,s.jsxs)(n.li,{children:["Project Link: ",(0,s.jsx)(n.a,{href:"https://github.com/PascalNehlsen/dso-python-tasks/tree/main/module-5/metascan",children:"https://github.com/PascalNehlsen/dso-python-tasks/tree/main/module-5/metascan"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>r});var s=t(6540);const i={},l=s.createContext(i);function d(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);