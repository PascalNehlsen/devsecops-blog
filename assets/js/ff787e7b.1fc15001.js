"use strict";(self.webpackChunkdso_dev_blog=self.webpackChunkdso_dev_blog||[]).push([[681],{7032:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>a,frontMatter:()=>l,metadata:()=>o,toc:()=>d});var s=i(4848),r=i(8453);const l={},t="Virtual Machine Setup with Nginx and SSH Configuration",o={id:"projects/vm-setup/overview",title:"Virtual Machine Setup with Nginx and SSH Configuration",description:"This project demonstrates how to configure an existing server with nginx, generate and use SSH keys for secure login, disable password-based authentication, use aliases for SSH connections, and manage multiple SSH identities.",source:"@site/docs/projects/vm-setup/00-overview.md",sourceDirName:"projects/vm-setup",slug:"/projects/vm-setup/overview",permalink:"/devsecops-blog/docs/projects/vm-setup/overview",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:0,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Projects Intro",permalink:"/devsecops-blog/docs/projects/intro"},next:{title:"Baby Tools Shop",permalink:"/devsecops-blog/docs/projects/baby-tools-shop/overview"}},c={},d=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"About the Project",id:"about-the-project",level:2},{value:"Technologies",id:"technologies",level:3},{value:"Features",id:"features",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Usage",id:"usage",level:2},{value:"Generating an SSH Key",id:"generating-an-ssh-key",level:3},{value:"Login",id:"login",level:3},{value:"Store SSH key",id:"store-ssh-key",level:3},{value:"Deactivate the password login",id:"deactivate-the-password-login",level:3},{value:"Start your webserver",id:"start-your-webserver",level:3},{value:"Display alternative index with nginx",id:"display-alternative-index-with-nginx",level:3},{value:"SSH connection aliases",id:"ssh-connection-aliases",level:3},{value:"SSH config for multiple identities",id:"ssh-config-for-multiple-identities",level:3},{value:"Contact",id:"contact",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"virtual-machine-setup-with-nginx-and-ssh-configuration",children:"Virtual Machine Setup with Nginx and SSH Configuration"})}),"\n",(0,s.jsxs)(n.p,{children:["This project demonstrates how to configure an existing server with ",(0,s.jsx)(n.strong,{children:"nginx"}),", generate and use ",(0,s.jsx)(n.strong,{children:"SSH keys"})," for secure login, disable password-based authentication, use ",(0,s.jsx)(n.strong,{children:"aliases"})," for SSH connections, and manage multiple ",(0,s.jsx)(n.strong,{children:"SSH identities"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#about-the-project",children:"About the Project"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#features",children:"Features"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#prerequisites",children:"Prerequisites"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#usage",children:"Usage"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#contact",children:"Contact"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"about-the-project",children:"About the Project"}),"\n",(0,s.jsxs)(n.p,{children:["This project focuses on setting up an existing server with ",(0,s.jsx)(n.strong,{children:"nginx"})," for web hosting. Additionally, it covers the secure configuration of ",(0,s.jsx)(n.strong,{children:"SSH"})," by generating SSH keys, using aliases for simpler SSH commands, disabling password-based login for enhanced security, and managing multiple SSH identities."]}),"\n",(0,s.jsx)(n.h3,{id:"technologies",children:"Technologies"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"nginx"})," for the web server"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"SSH"})," for secure server access"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Set up and configure nginx on the server"}),"\n",(0,s.jsx)(n.li,{children:"Generate and use SSH keys for secure login"}),"\n",(0,s.jsx)(n.li,{children:"Disable password-based SSH login for security"}),"\n",(0,s.jsx)(n.li,{children:"Use SSH aliases for easier login commands"}),"\n",(0,s.jsx)(n.li,{children:"Manage multiple SSH identities for different servers"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"An existing server (Linux-based) with SSH access"}),"\n",(0,s.jsx)(n.li,{children:"Login data for the virtual machine"}),"\n",(0,s.jsx)(n.li,{children:"Root or sudo privileges on the server"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(n.h3,{id:"generating-an-ssh-key",children:"Generating an SSH Key"}),"\n",(0,s.jsx)(n.p,{children:"To secure access to your server, generate an SSH key on your local machine:"}),"\n",(0,s.jsx)(n.p,{children:"Generate a new SSH key:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ssh-keygen -t ed25519\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Specify the path where you want to store the key"}),"\n",(0,s.jsx)(n.li,{children:"Enter passphrase depending on personal requirements"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"login",children:"Login"}),"\n",(0,s.jsx)(n.p,{children:"Login to your Virtual Machine (example ip address):"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ssh USER@192.655.265.55\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Remember fingerprint"}),"\n",(0,s.jsx)(n.li,{children:"Enter your login password for the server"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"store-ssh-key",children:"Store SSH key"}),"\n",(0,s.jsx)(n.p,{children:"Store the SSH key on your virtual machine (example path):"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ssh-copy-id -i ~/.ssh/key.pub USER@192.655.265.55\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Important:"})," Use the public (key.pub) key"]}),"\n",(0,s.jsx)(n.li,{children:"Enter your login password for the server"}),"\n",(0,s.jsx)(n.li,{children:"Login to the server using the ssh key"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ssh -i ~/.ssh/key.pub USER@192.655.265.55\n"})}),"\n",(0,s.jsx)(n.h3,{id:"deactivate-the-password-login",children:"Deactivate the password login"}),"\n",(0,s.jsx)(n.p,{children:"For your safety we are deactivating the password login:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Important:"})," First try if you can log in with your ssh key!"]}),"\n",(0,s.jsx)(n.li,{children:"Go to the server config:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo nano /etc/ssh/sshd_config\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Search for the PasswordAuthentication entry"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"#PasswordAuthentication no\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Remove the comment character (entry color is changing)"}),"\n",(0,s.jsx)(n.li,{children:"Save the file"}),"\n",(0,s.jsx)(n.li,{children:"Restart the SSH service:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo systemctl restart ssh.service\n"})}),"\n",(0,s.jsx)(n.h3,{id:"start-your-webserver",children:"Start your webserver"}),"\n",(0,s.jsx)(n.p,{children:"Install nginx to open the machine as a web server:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Update your repositories on the Server:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo apt update\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Install nginx:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo apt install nginx -y\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Open the server on your Browser (the address is your vm ip)"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"display-alternative-index-with-nginx",children:"Display alternative index with nginx"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Create the alternate directory:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo mkdir /var/www/alternatives\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Create your alternative index.html:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo touch /var/www/alternatives/your-index.html\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Configure nginx:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo nano /etc/nginx/sites-enabled/alternatives\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Configure the following file for port 8081:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"server {\r\n    listen: 8081;\r\n    listen[::]8081;\r\n\r\n    root /var/www/alternatives;\r\n    index your-index.html;\r\n\r\n    location / {\r\n        try_files $uri $uri/ =404;\r\n    }\r\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Create your alternate index.html:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo nano /var/www/alternatives/your-index.html\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'<!DOCTYPE html>\r\n<html lang="en">\r\n<head>\r\n    <meta charset="UTF-8">\r\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\r\n    <title>Your Index</title>\r\n</head>\r\n<body>\r\n    <h1>Hello, this is my new index.html!</h1>\r\n</body>\r\n</html>\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Restart your nginx service:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo service nginx restart\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Open the server on your Browser (the address is your vm ip + port :8081)"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"ssh-connection-aliases",children:"SSH connection aliases"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Create your alias with an absolute path:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'alias your_alias="ssh -o StrictHostKeyChecking=False -i ~/.ssh/key.pub USER@192.655.265.55"\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Show all existing alias:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"alias\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Login with your alias:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"your_alias\n"})}),"\n",(0,s.jsx)(n.h3,{id:"ssh-config-for-multiple-identities",children:"SSH config for multiple identities"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Change the config file of your SSH"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"nano ~/.ssh/config\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"HOST 192.655.265.55\r\n  User your_username\r\n  PreferredAuthentications publickey\r\n  IdentityFile ~/.ssh/key (the private key)\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Login through your identity:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ssh 192.655.265.55\n"})}),"\n",(0,s.jsx)(n.h2,{id:"contact",children:"Contact"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Pascal Nehlsen - ",(0,s.jsx)(n.a,{href:"https://www.linkedin.com/in/pascal-nehlsen",children:"LinkedIn"})," - ",(0,s.jsx)(n.a,{href:"mailto:mail@pascal-nehlsen.de",children:"mail@pascal-nehlsen.de"})]}),"\n",(0,s.jsxs)(n.li,{children:["Project Link: ",(0,s.jsx)(n.a,{href:"https://github.com/PascalNehlsen/v-server-setup",children:"https://github.com/PascalNehlsen/v-server-setup"})]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>o});var s=i(6540);const r={},l=s.createContext(r);function t(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);