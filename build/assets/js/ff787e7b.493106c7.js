"use strict";(self.webpackChunkdso_dev_blog=self.webpackChunkdso_dev_blog||[]).push([[681],{7032:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>d,frontMatter:()=>t,metadata:()=>l,toc:()=>c});var i=s(4848),r=s(8453);const t={},a="Virtual Machine Setup with Nginx and SSH Configuration",l={id:"projects/vm-setup/overview",title:"Virtual Machine Setup with Nginx and SSH Configuration",description:"In this blog post, you\u2019ll learn how to configure an existing virtual machine (VM) with nginx as a web server while also setting up a secure SSH configuration. We will walk through generating SSH keys, disabling password-based authentication, using SSH aliases, and managing multiple SSH identities.",source:"@site/docs/projects/vm-setup/00-overview.md",sourceDirName:"projects/vm-setup",slug:"/projects/vm-setup/overview",permalink:"/devsecops-blog/docs/projects/vm-setup/overview",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:0,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Projects Intro",permalink:"/devsecops-blog/docs/projects/intro"},next:{title:"Baby Tools Shop",permalink:"/devsecops-blog/docs/projects/baby-tools-shop/overview"}},o={},c=[{value:"Quick Start (README)",id:"quick-start-readme",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Conclusion",id:"conclusion",level:3},{value:"Contact",id:"contact",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"virtual-machine-setup-with-nginx-and-ssh-configuration",children:"Virtual Machine Setup with Nginx and SSH Configuration"})}),"\n",(0,i.jsx)(n.p,{children:"In this blog post, you\u2019ll learn how to configure an existing virtual machine (VM) with nginx as a web server while also setting up a secure SSH configuration. We will walk through generating SSH keys, disabling password-based authentication, using SSH aliases, and managing multiple SSH identities."}),"\n",(0,i.jsx)(n.h2,{id:"quick-start-readme",children:"Quick Start (README)"}),"\n",(0,i.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A Linux-based server with SSH access"}),"\n",(0,i.jsx)(n.li,{children:"Root or sudo privileges"}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Generate an SSH Key\r\nGenerate an SSH key on your local machine to secure access to your server:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ssh-keygen -t ed25519\n"})}),"\n",(0,i.jsx)(n.p,{children:"Follow the instructions and store the key in a secure location. Optionally, you can add a passphrase for extra security."}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Login to the VM\r\nLogin to your virtual machine using SSH (replace with your VM\u2019s IP address):"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ssh USER@192.655.265.55\n"})}),"\n",(0,i.jsx)(n.p,{children:"Accept the fingerprint and enter your server\u2019s password."}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Store the SSH Key on the VM\r\nCopy your public SSH key to the VM:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ssh-copy-id -i ~/.ssh/key.pub USER@192.655.265.55\n"})}),"\n",(0,i.jsx)(n.p,{children:"Now you can log in using the key:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ssh -i ~/.ssh/key.pub USER@192.655.265.55\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Disable Password Authentication\r\nFor enhanced security, disable password-based login on the server."}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"First, verify that you can log in with your SSH key."}),"\n",(0,i.jsx)(n.li,{children:"Edit the SSH configuration on the server:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo nano /etc/ssh/sshd_config\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Find the ",(0,i.jsx)(n.code,{children:"PasswordAuthentication"})," line and change it from:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"#PasswordAuthentication no\n"})}),"\n",(0,i.jsx)(n.p,{children:"to:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"PasswordAuthentication no\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Save the file and restart the SSH service:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo systemctl restart ssh.service\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsx)(n.li,{children:"Install and Configure Nginx\r\nInstall nginx to run the server as a web server:"}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Update the package repositories:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo apt update\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Install nginx:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo apt install nginx -y\n"})}),"\n",(0,i.jsx)(n.p,{children:"Open the server in your browser (using the VM's IP address)."}),"\n",(0,i.jsxs)(n.ol,{start:"6",children:["\n",(0,i.jsx)(n.li,{children:"Set Up an Alternate Index for Nginx\r\nCreate an alternative index page and configure nginx to serve it on a different port (8081)."}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Create a new directory for the alternate site:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo mkdir /var/www/alternatives\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Create the new index.html:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo touch /var/www/alternatives/your-index.html\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Add content to ",(0,i.jsx)(n.code,{children:"your-index.html"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'<!DOCTYPE html>\r\n<html lang="en">\r\n<head>\r\n    <meta charset="UTF-8">\r\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\r\n    <title>Your Index</title>\r\n</head>\r\n<body>\r\n    <h1>Hello, this is my new index.html!</h1>\r\n</body>\r\n</html>\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Configure nginx to serve this site on port 8081:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo nano /etc/nginx/sites-enabled/alternatives\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Add the following configuration:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-nginx",children:"server {\r\n    listen 8081;\r\n    listen [::]:8081;\r\n\r\n    root /var/www/alternatives;\r\n    index your-index.html;\r\n\r\n    location / {\r\n        try_files $uri $uri/ =404;\r\n    }\r\n}\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Restart the nginx service:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo service nginx restart\n"})}),"\n",(0,i.jsx)(n.p,{children:"Open the server in your browser with the VM\u2019s IP address and port 8081."}),"\n",(0,i.jsx)(n.h1,{id:"detailed-explanation-writeup",children:"Detailed Explanation (Writeup)"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Why Use SSH Keys and Disable Password Authentication?\r\nSSH keys provide stronger authentication compared to password-based login. By disabling password login, you add an extra layer of security, reducing the risk of brute-force attacks. This is especially important when managing servers in production environments."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Setting Up Nginx for Multiple Sites\r\nBy configuring nginx to serve an alternative ",(0,i.jsx)(n.code,{children:"index.html"})," on a different port, you can host multiple websites or test environments on the same server. This is a useful approach for separating staging environments or hosting multiple microservices."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Using SSH Aliases for Easier Connections\r\nInstead of typing out long SSH commands every time, you can create an alias for frequently accessed servers. For example, add the following alias to your shell configuration (~/.bashrc or ~/.zshrc):"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'alias myserver="ssh -o StrictHostKeyChecking=False -i ~/.ssh/key.pub USER@192.655.265.55"\n'})}),"\n",(0,i.jsx)(n.p,{children:"This allows you to connect to your server by simply typing:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"myserver\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Managing Multiple SSH Identities\r\nIf you work with multiple servers, each with its own SSH key, you can manage them using the SSH configuration file. This allows you to use different keys for different servers without having to specify them each time you connect."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Edit your ",(0,i.jsx)(n.code,{children:"~/.ssh/config"})," file and add an entry for each server:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"Host myserver\r\n    User your_username\r\n    HostName 192.655.265.55\r\n    IdentityFile ~/.ssh/key\n"})}),"\n",(0,i.jsx)(n.p,{children:"Now you can connect to your server with:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ssh myserver\n"})}),"\n",(0,i.jsx)(n.h3,{id:"conclusion",children:"Conclusion"}),"\n",(0,i.jsx)(n.p,{children:"By following this guide, you can set up a secure and efficient virtual machine with nginx for web hosting and SSH keys for access control. Implementing SSH aliases and multiple identities further streamlines server management, especially when dealing with multiple environments."}),"\n",(0,i.jsx)(n.p,{children:"If you have any questions or need further assistance, feel free to reach out!"}),"\n",(0,i.jsx)(n.h2,{id:"contact",children:"Contact"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Pascal Nehlsen - ",(0,i.jsx)(n.a,{href:"https://www.linkedin.com/in/pascal-nehlsen",children:"LinkedIn"})," - ",(0,i.jsx)(n.a,{href:"mailto:mail@pascal-nehlsen.de",children:"mail@pascal-nehlsen.de"})]}),"\n",(0,i.jsxs)(n.li,{children:["Project Link: ",(0,i.jsx)(n.a,{href:"https://github.com/PascalNehlsen/v-server-setup",children:"https://github.com/PascalNehlsen/v-server-setup"})]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var i=s(6540);const r={},t=i.createContext(r);function a(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);